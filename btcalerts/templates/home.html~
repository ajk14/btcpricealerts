{% extends "base.html" %}

{% load bootstrap_toolkit %}
{% load custom_tags %} 

{% block title %}
Bitcoin Price Alerts
{% endblock %}

{% block content%}
{% if user.is_authenticated %}
{% if user.is_active %}
<div class="span10 offset1">
<h3>Your Active Alerts</h3>
<table class="table">
<tr>
  <td><strong>Type</strong></td>
  <td><strong>Destination</strong></td>
  <td><strong>Alert When</strong></td>
  <td><strong>Threshold</strong></td>
  <td><strong>Delete</strong></td>
</tr>
{% for alert in myAlerts %}
<tr>
  <td>
    {{ alert.delivery_type }}
  </td>
  <td>
    {{ alert.destination }}
  </td>
  <td>
    {{ alert.alert_when }}
  </td>
  <td>
    ${{ alert.threshold }}
  </td>
  <td><a href="/delete?id={{alert.id}}"><i class="icon-trash"></i></a></td>
</tr>
{% endfor %}
</table>
</div>
<div class="span5">
  <form class="form-signin" action="/alert/" method="post">
    <h2 class="form-signin-heading">Request New Alert</h2>
    {% csrf_token %}
    {% if phone_unprovided %}
    <p class="text-error">You must <a href="/phone/">confirm a phone nubmer</a> for text alerts.</p>
    {% endif %}
    {% if messages %}
    <ul class="messages">
      {% for message in messages %}
        {% if message.tags == 'error' %}     
        <p class="text-error">{{message}}</p>
	{% else %}
        <p class="text-success">{{message}}</p>
        {% endif %}
      {% endfor %}
    </ul>
    {% endif %}
    {% if alert_succeeded %}
    You have created a new alert.
    {% endif %}
    {% if alert_failed %}
    Your new alert failed to be created.
    {% endif %}

    {{form.delivery_type|as_bootstrap}}
    {% if user.phone %}
    <p style="display:none" id="text_message">Sending text alerts to {{user.phone|phonenumber}} - <a href="/phone">Change</a></p>
    {% else %}
    <p style="display:none" id="text_message"><a href="/phone">Add a phone number for SMS alerts</a></p>
    {% endif %}
    <p style="display:none" id="email_message">Your e-mail alerts will be sent to {{user.email}}</p>
    {{form.alert_when|as_bootstrap}}
    {{form.threshold|as_bootstrap}}
    <button type="submit" class="btn">Request Alert</button>
 </form>
</div>

{% else %}
<div class="span 11 offset1">
<p class="lead">
Your account has not yet been activated. Please check your email and click on the link to activate your account.
</p>
</div>
{% endif %}
{% else %}
      <div class="jumbotron">
        <h1>Real-Time Bitcoin Alerts</h1>
        <p class="lead">Receive an e-mail or text message when the price of Bitcoin rises above or falls below a certain threshold!</p>
        <a class="btn btn-large btn-success" href="/accounts/register/">Set up your alert now!</a>
      </div>

      <hr>
      <div class="row-fluid marketing">
{% endif %}

	<!--        <div class="span6">
          <h4>Subheading</h4>
          <p>Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum.</p>

          <h4>Subheading</h4>
          <p>Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Cras mattis consectetur purus sit amet fermentum.</p>

          <h4>Subheading</h4>
          <p>Maecenas sed diam eget risus varius blandit sit amet non magna.</p>
        </div>

        <div class="span6">
          <h4>Subheading</h4>
          <p>Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum.</p>

          <h4>Subheading</h4>
          <p>Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Cras mattis consectetur purus sit amet fermentum.</p>

          <h4>Subheading</h4>
          <p>Maecenas sed diam eget risus varius blandit sit amet non magna.</p>
        </div>
-->
{% endblock %}
